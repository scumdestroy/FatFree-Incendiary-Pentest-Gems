## ldapsearch

Obtain LAPS passwords for domain computers using the linux based ldapsearch tool

[Dump Laps Passwords with LDAPSearch by Rob Fuller](https://room362.com/post/2017/dump-laps-passwords-with-ldapsearch/)
```	
	ldapsearch -x -h 192.168.80.10 -D "helpdesk" -w ASDqwe123 -b "dc=sittingduck,dc=info" "(ms-MCS-AdmPwd=*)" ms-MCS-AdmPwd

	-x - Use basic authentication
	-h 192.168.80.10 - Connect to the Domain Controller for ldap
	-D "helpdesk" -w ASDqwe123 - Login as the helpdesk user, with the password ASDqwe123
	-b "dc=sittingduck,dc=info" - This loads the base LDAP object of the entire domain.
	"(ms-MCS-AdmPwd=*)" - Filter out any objects that I canâ€™t see a value for ms-MCS-AdmPwd for. (If you have rights as that user to see even one Administrator password, this will show it.)
	ms-MCS-AdmPwd - Only show me the ms-MCS-AdmPwd object (which by default includes the object name and DN so you will still know what host it belongs to)
```

System Lookup
```
    ldapsearch -x -h ldap.domain.com -L -s sub -b ou=ITsystems,ou=computers,o=domain.com "(cn=itwks-001.it.domain.com)" <filteroptional>
```

User lookup by uid
```
    ldapsearch -x -h ldap.domain.com -b o=domain.com -s sub uid=jdoe| egrep "uid:|uidnumber:|gidnumber:|cn:|gecos:|description:|loginshell:|homedirectory:"
```

User lookup by name
```
    ldapsearch -x -h ldap.domain.com -b o=domain.com -s sub '(&(sn=Tubberville)(givenname=James))'
```

Set Pass as self
```
    ldappasswd -H ldaps://ldap.domain.com:6361 -D 'cn=John Doe (jdoe),ou=hr,ou=users,o=domain.com' -S -W -A  
```

Set Pass as Admin
```
    ldappasswd -H ldaps://ldap.domain.com:6361 -x -D 'cn=admin,ou=hr,ou=users,o=domain.com' -S -W 'uid=jdoe,ou=hr users,o=domain.com '   
```

Get FQDN
```
    hostname --fqdn
    or
    hostname -f
```
